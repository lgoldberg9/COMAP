\documentclass[12pt]{article} 

\usepackage{blindtext}
\usepackage[utf8]{inputenc}
\usepackage[american]{babel}

\usepackage{csquotes}
\usepackage[style=numeric,
    citestyle=numeric,
    backend=biber,
    natbib=true,
url=true]{biblatex}

\usepackage[hidelinks]{hyperref}
\usepackage{setspace}
\usepackage{microtype}

\bibliography{main.bib}

\usepackage[margin=1in]{geometry}
\usepackage{graphicx}

\usepackage{amsmath, amssymb, amsthm}


% Custom macros
\newcommand{\la}{\overleftarrow}
\newcommand{\ra}{\overrightarrow}
\newcommand{\ca}{\overleftrightarrow}
\newcommand{\R}{\mathbb{R}}
\newcommand{\abs}[1]{\left|#1\right|}
\DeclareMathOperator*{\argmin}{\mathrm{arg\,min}}

\title{Numerical simulation of two-dimensional heat convection-diffusion with
ellipsoid geometries}

\date{February 1, 2016}

\begin{document}

\maketitle
\tableofcontents

\begin{abstract}

\end{abstract}

\section{Introduction}

The basis of this paper is to develop a model that permits a person to maintain their preferred temperature of the bathtub water while minimizing water consumption.    

\section{Model overview}

Throughout this work we will denote the spatial region under scrutiny by
$\Omega \subseteq \R^2$, and we write $\partial \Omega$ to indicate the
boundary of the region. The function $T : \Omega \times \R_{\geq 0} \to \R$
will denote the temperature $T = T(x,y,t)$, and the functions $v_x : \Omega
\times \R_{\geq 0} \to \R$ and $v_y : \Omega \times \R_{\geq 0} \to \R$ will
denote $v_x = v_x(x,y,t)$ the horizontal and $v_y = v_y(x,y,t)$ the vertical
components of the velocity of the fluid flow. 

\subsection{Two-dimensional Navier-Stokes formulation}

The Navier-Stokes equations for an incompressible fluid are given by
\begin{align}
    \nabla \cdot v &= 0 \\
    \frac{\partial v}{\partial t} + (v \cdot \nabla) v &= -
    \frac{1}{\rho} \nabla p + \alpha \nabla^2 v
    \label{eq:\theequation}
\end{align}
where $v = (v_x, v_y)$ is the fluid velocity, $\rho$ denotes mass density of
the fluid, and $p$ denotes pressure. Incompressibility is incorporated
through Equation (), since nonzero divergence implies the presence of either
sources or sinks of fluid. Now because $v$ is two-dimensional, Equation
() actually implies a pair of partial differential equations for both the $x$
and $y$ components. The pressure $p$ is determined through the Poisson equation
\begin{equation}
    \nabla^2 p = b,
    \label{eq:\theequation}
\end{equation}
where $b$ is taken as a constant term for the purposes of this study. Many
wonderful resources exist online for understanding the formulation of these
equations, specifically Barba's work \cite{12-steps}, but we do not include a
derivation of these relations here.

\subsection{Heat convection-diffusion equation}

The heat convection-diffusion equation found in the literature
\cite{convection-diffusion},
\begin{equation}
    \frac{\partial T}{\partial t} - \alpha \nabla^2 T + v \cdot \nabla T =
    0,
    \label{eq:\theequation}
\end{equation}
is a combination of parabolic and hyperbolic partial differential equations
relating the temporal change in temperature with its spatial diffusion and
the flow of heat packets elsewhere in the fluid.     Here, $\nabla$ is the
gradient operator $\left( \frac{\partial}{\partial x},
\frac{\partial}{\partial y} \right)$, $\nabla^2$ denotes the Laplacian
$\frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2}$, $v =
(v_x, v_y)$ denotes the fluid velocity vector, and $\alpha$ is a diffusivity
constant.

The ubiquity of parabolic PDEs in modeling scientific phenomenon is well
known, since it captures the essence of diffusive processes. Elliptic PDEs
often arise out of physical environments with a present potential field
(e.g.  gravitational or electrostatic), or in the cases of incompressible
fluid flow \cite{convection-diffusion, ames}. We use the latter for
motivating this model, as bathtub water exhibits the standard
characteristics of incompressible fluid.

\subsection{Numerical methods}

We proceed by providing a brief overview of the numerical methods used in
this study. To approximate the solution to a PDE, we discretize the region
$\Omega$ under consideration into a coordinate mesh. For convention, we
write $T_{i,j}^{n}$ to denote the temperature at the $(i,j)$ mesh coordinate
at the time interval $t=n$. 

Modifying the notation employed by Ames \cite{ames}, we establish the
following nomenclature for the numerical operations in the model (the use of $T$
is without loss of generality and can be substituted for $v$ and $p$ as well):

\begin{center}
    \begin{tabular}[]{ll}
        $\ra{\Delta_i} T_{i,j}^n = T_{i+1,j}^n - T_{i,j}^n$ & Forward
        differencing \\
        $\la{\Delta_i} T_{i,j}^n = T_{i,j}^n - T_{i-1,j}^n$ & Backward differencing \\
        $\ca{\Delta_i} T_{i,j}^n = T_{i+1/2,j}^n - T_{i-1/2,j}^n$ & Central differencing
    \end{tabular}
\end{center}

The estimation of partial derivatives using the above techniques result in
different rates of convergence as the numerical increment decreases. In
particular, we have
\begin{equation}
    \frac{\partial T_{i,j}^n}{\partial x} = \frac{\ra{\Delta_j}T_{i,j}^n}{\Delta
    x}+ O(\Delta x),
    \label{eq:\theequation}
\end{equation}
(while we use differentiation along the horizontal axis, the
convergence is without loss of generality of axis), and we similarly have
\begin{equation}
    \frac{\partial T_{i,j}^n}{\partial x} = \frac{\la{\Delta_j}T_{i,j}^n}{\Delta
    x} + O(\Delta x),
    \label{eq:\theequation}
\end{equation}
while for central differencing, we have
\begin{equation}
     \frac{\partial T_{i,j}^n}{\partial x} = \frac{\ca{\Delta_j}T_{i,j}^n}{\Delta
    x} + O((\Delta x)^2).
    \label{eq:\theequation}
\end{equation}
Indeed, as $\Delta x \to 0$ we see that central differencing has a quadratic
rate of convergence, while forward and backward differencing are linear. For
this advantage we employ central differencing in computing spatial derivatives.
However, as the time evolution is simulated on the fly, we cannot have access to
$T_{i,j}^{n+1}$ when computing $T_{i,j}^n$. We consequently use backward
differencing to estimate the time derivative.

The approximated Navier-Stokes equations now read
\begin{align}
    \frac{\ca{\Delta_{j}}(v_x)_{i,j}^n}{\Delta x} +
    \frac{\ca{\Delta_{i}}(v_y)_{i,j}^n}{\Delta y} &= 0 \\
    \frac{\la{\Delta_n}v^{n}_{i,j}}{\Delta t} + (v_x)_{i,j}^{n}
    \frac{\ca{\Delta_{j}}(v_x)_{i,j}^n}{\Delta x} + (v_y)_{i,j}^n
    \frac{\ca{\Delta_{i}}(v_y)_{i,j}^n}{\Delta y} &=
    -\frac{1}{\rho} \left(  \frac{\ca{\Delta_j}p_{i,j}^n}{\Delta
    x}+\frac{\ca{\Delta_i}p_{i,j}^n}{\Delta y}  \right) + \alpha
    \left(\frac{\ca{\Delta_{j}}^2(v_x)_{i,j}^n}{(\Delta x)^2} + 
    \frac{\ca{\Delta_{i}}^2(v_y)_{i,j}^n}{(\Delta y)^2}
    \right).
\end{align}
The Poisson equation is 
\begin{equation}
    \frac{\ca{\Delta_{j}}^2p_{i,j}^n}{(\Delta x)^2} + 
    \frac{\ca{\Delta_{i}}^2p_{i,j}^n}{(\Delta y)^2}
    = b.
    \label{eq:\theequation}
\end{equation}
Finally, heat convection-diffusion is given by
\begin{equation}
    \frac{\la{\Delta_n}T_{i,j}^n}{\Delta t} - \alpha \frac{\ca{\Delta_{j}}^2T_{i,j}^n}{(\Delta x)^2} + 
    \frac{\ca{\Delta_{i}}^2T_{i,j}^n}{(\Delta y)^2} + (v_x)_{i,j}^n
    \frac{\ca{\Delta_{j}}T_{i,j}^n}{\Delta x} + (v_y)_{i,j}^n
    \frac{\ca{\Delta_{i}}T_{i,j}^n}{\Delta y} = 0
    \label{eq:\theequation}
\end{equation}

The algorithmic approach we take is as follows. Using the numerical formulas
given above, isolate the time derivative and set its value to the other side of
the equation. In the case of temperature, for example, we then update its value
with
\begin{equation}
    T_{i,j}^{n+1} \leftarrow T_{i,j}^{n} + \Delta t \cdot \frac{\partial
        T_{i,j}^n}{\partial t}.
    \label{eq:\theequation}
\end{equation}
This pattern is used throughout the computer implementation of these models. The
remaining question is the stability of these results. In fact, as we shall
discuss in Section 4, these equations can be highly unstable, especially with a
naive assignment of parameter values.



\subsection{Bathtub optimization problem}

The goal of this study is to identify a process through which the avid bather
may seek to achieve uniform water temperature, ideally wasting as little water
as possible. Using the aforementioned numerical models to simulate bathtub
dynamics, we propose an optimization problem by which to approach this goal. Let
$t_{\mathrm{total}}$ indicate the period in which the faucet is turned on, let
$T_{\mathrm{f}}$ denote the temperature of the water in the faucet, and let
$V(t)$ denote the total volume of water that has left the faucet. We assume that
$\frac{dV}{dt} = c$, i.e., the strength of the faucet is fixed at a chosen $c$ throughout the
duration of the bath. Now, consider the surface integral
\begin{equation}
    f_{\mathrm{cont}}(t) = \int_{\Omega} \abs{T(x,y,t) - T_{\mathrm{f}}} \ d\omega.
    \label{eq:\theequation}
\end{equation}
We propose the minimization problem
\begin{equation}
    \argmin_{c} \int_{0}^{t_{\mathrm{total}}} V(t) \ dt \quad \text{such that}
    \quad \int_{0}^{t_{\mathrm{total}}} f_{\mathrm{cont}}(t) \ dt < \gamma,
    \label{eq:\theequation}
\end{equation}
where $\gamma$ is some tolerance for variation. This is minimization
problem is subject to a total variation constraint, which has been subject to
considerable study, especially within the context of medical imaging
\cite{Zhang2005}.

This optimization leads to a natural discretization. We rewrite:
\begin{align}
    V(t) &\longrightarrow V^t \\
    \frac{dV}{dt} = c &\longrightarrow V^{t+1} - V^t = c \\
    f_{\mathrm{cont}}(t) = \int_{\Omega} \abs{T(x,y,t) - T_{\mathrm{f}}} \
    d\omega &\longrightarrow f_{\mathrm{disc}}(t) = \sum_{x,y}\abs{T(x,y,t) -
        T_{\mathrm{f}}},
\end{align}
which translate to the problem
\begin{equation}
    \argmin_{c} \sum_{t=0}^{t_{\mathrm{total}}}V^{t_{\mathrm{total}}} \quad \text{such that} \quad
    \sum_{t=0}^{t_{\mathrm{total}}} f_{\mathrm{disc}}(t) < \gamma.
    \label{eq:\theequation}
\end{equation}

The minimization problem posed here captures the major features of the bathtub
optimizer problem. In our problem, the bather need not frequently calibrate the
settings of the bathtub; rather, the bathtub ``policy'' reduces to an initial
choice of $c$. Moreover, the underlying objective is not to get an even temperature
distribution (as the bather may simply leave the faucet on arbitrarily long to
achieve this), but to conserve as much water as possible. The temperature
distribution problem, then, must be seen within the framework of water
conservation first and not vice versa. On the other hand, the best volume
minimization policy is $c=0$, so the bounded temperature total variation
constraint incorporates the desired $c > 0$ aspects of the problem. Finally,
from both a numerical perspective and a feasibility perspective, demanding
complete temperature uniformity, $\gamma = 0$, is impossible. Instead, $\gamma$
represents the degree of tolerance to which the bather can expect a range of
temperatures in the bathtub.

\section{Empirical results}

Our work is highly preliminary and requires more study in order to better
calibrate our models and properly run experiments. However, we simulated a
number of variously parametrized situations and can report on the model as a
proof of concept.

\begin{center}
\includegraphics[width=0.8\textwidth]{../plots/diffusion.png}

Figure 1: The heat diffusion process in the case of a stationary fluid and
constant faucet tap. The mesh
dimensions are $50 \times 50$, $\alpha = 10^{-3}$, $T_{\mathrm{tub}} = 10$, and
$T_{\mathrm{faucet}} = 30$.
\end{center}

For example, the above figure shows a heat-diffusion process on a stationary
fluid. The white ellipsoid in the left side of the image represents temperature
emanating from the faucet source. Since the faucet water temperature is greater
than the rest of the bathtub water, we observe temperature diffusion across the
bathtub over time.

The same setup yields a decreasing total variation of temperature as a function
of time, which corroborates with the intuition that heat diffusing from a source
increases the uniformity of the bathtub heat.

\begin{center}
    \includegraphics[width=0.5\textwidth]{../plots/tv-01.png}

    Figure 2: Temperature total variation over time in the case of a stationary
    fluid, with the same parameters as in Figure 1. The monotonicity of the TV
    function is in line with basic intution.
\end{center}

We can also examine the case in which the faucet water is turned on only for the
initial instant. Here, as we expect, the overall temperature level decreases
rapidly after the first time interval, but the uniformity increases. 

\begin{center}
    \includegraphics[width=0.8\textwidth]{../plots/diffusion-02.png}

    Figure 3: The heat diffusion process in the case of a stationary fluid and
    temporary faucet tap. The mesh dimensions are $50 \times 50$, $\alpha =
    10^{-3}$, $T_{\mathrm{tub}} = 10$, and $T_{\mathrm{faucet}} = 30$.
\end{center}

However, as we modeled total variation as deviation from the faucet temperature,
we see that the total variation receives a higher penalty than before.


\begin{center}
    \includegraphics[width=0.5\textwidth]{../plots/tv-02.png}

    Figure 4: Temperature total variation over time in the case of a stationary
    fluid, with the same parameters as in Figure 3. The monotonicity of the TV
    function is in line with basic intution.
\end{center}

The fact that the total variation performs so poorly in this case has
implications for the policy problem, which we will discuss in the next section.
Generalizing beyond stationary fluids reveals a number of critical issues of the
numerical techniques employed in this study.


\section{Discussion}

\nocite{*}

\printbibliography

\end{document}
